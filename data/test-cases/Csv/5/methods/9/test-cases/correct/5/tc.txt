@Test public void shouldPrintRecords() throws SQLException, IOException { final ResultSet resultSet = mock(ResultSet.class); final ResultSetMetaData metaData = mock(ResultSetMetaData.class); when(resultSet.getMetaData()).thenReturn(metaData); when(metaData.getColumnCount()).thenReturn(2); when(resultSet.next()).thenReturn(true).thenReturn(true).thenReturn(false); when(resultSet.getString(1)).thenReturn("1").thenReturn("2").thenReturn("3"); when(resultSet.getString(2)).thenReturn("4").thenReturn("5").thenReturn("6"); final StringWriter out = new StringWriter(); new CSVPrinter(out, CSVFormat.DEFAULT).printRecords(resultSet); }